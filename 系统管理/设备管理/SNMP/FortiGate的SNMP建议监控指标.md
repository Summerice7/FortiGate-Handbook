# FortiGate的SNMP建议监控指标

**（若本页表格无法正常完整显示，请尝试刷新此页面可解决）**

## FortiGate私有MIB

私有MIB库需要手工导入。

<img src="..\..\..\images\image-20220823161241171.png" alt="image-20220823161241171" style="zoom:50%;" />

最常见的SNMP健康指标：FortiGate的CPU、MEM、新建、并发、接口流量等等。

### CPU OID

```
Name:        fgSysCpuUsage  OID:        1.3.6.1.4.1.12356.101.4.1.3.0
```

<img src=".\..\..\..\images\image-20220823101650710.png" alt="image-20220823101650710" style="zoom:50%;" />

### MEM OID

```
Name:        fgSysMemUsage  OID:        1.3.6.1.4.1.12356.101.4.1.4.0
```

<img src="..\..\..\images\image-20220823102120209.png" alt="image-20220823102120209" style="zoom:50%;" />

### 并发会话数OID

```
Name:        fgSysSesCount    OID:       1.3.6.1.4.1.12356.101.4.1.8.0
```

<img src="..\..\..\images\image-20220823102433196.png" alt="image-20220823102433196" style="zoom:50%;" />

### 新建会话数OID

```
Name:        fgSysSesRate1  OID:        1.3.6.1.4.1.12356.101.4.1.11.0
```

<img src="..\..\..\images\image-20220823102546657.png" alt="image-20220823102546657" style="zoom:50%;" />

### 接口流量OID

>**这个部分使用的公共的MIB节点通过复合公式计算出来的接口带宽值，不是使用的私有mib，几乎所有场景的设备都是通过这个私有MIB来读取的接口流量。**

| 复合参数                               |                |                                                              |                  |                                                              |
| -------------------------------------- | -------------- | ------------------------------------------------------------ | ---------------- | ------------------------------------------------------------ |
| 接口bps（in）<br/>Inbound Throughput   | 使用复合表达式 | 吞吐量：间隔t秒执行2次获取ifHCInOctets.x (.1.3.6.1.2.1.31.1.1.1.6.x)的值，结果分别为ifHCInOctets.x.time1和ifHCInOctets.x.time2。<br/>interface x的in_bps = ( ifHCInOctets.x.time2 - ifHCInOctets.x.time1) * 8 / t | 吞吐量：数字,bps | 吞吐率＝接口吞吐量/接口最大吞吐量=60%<br/>Inbound Utilization |
| 接口bps（out）<br/>Outbound Throughput | 使用复合表达式 | 吞吐量：间隔t秒执行2次获取ifHCOutOctets.x(.1.3.6.1.2.1.31.1.1.1.10.x)的值，结果分别为ifHCOutOctets.x.time1和ifHCOutOctets.x.time2。<br/>interface x的out_bps = ( ifHCOutOctets.x.time2 - ifHCOutOctets.x.time1) * 8 / t | 吞吐量：数字,bps | 吞吐率＝接口吞吐量/接口最大吞吐量=60<br/>Outbound Utilization |

```
Name:        ifHCInOctets
Type:        OBJECT-TYPE
OID:        1.3.6.1.2.1.31.1.1.1.6

Name:        ifHCOutOctets
Type:        OBJECT-TYPE
OID:        1.3.6.1.2.1.31.1.1.1.10

Type:        OBJECT-TYPE
OID:        1.3.6.1.2.1.31.1.1.1
Full path:        iso(1).org(3).dod(6).internet(1).mgmt(2).mib-2(1).ifMIB(31).ifMIBObjects(1).ifXTable(1).ifXEntry(1)
Sequences:        
       1: ifName - DisplayString(4 - octets)
       2: ifInMulticastPkts - Counter32(65 - counter (32 bit))
       3: ifInBroadcastPkts - Counter32(65 - counter (32 bit))
       4: ifOutMulticastPkts - Counter32(65 - counter (32 bit))
       5: ifOutBroadcastPkts - Counter32(65 - counter (32 bit))
       6: ifHCInOctets - Counter64(70 - counter (64 bit))
       7: ifHCInUcastPkts - Counter64(70 - counter (64 bit))
       8: ifHCInMulticastPkts - Counter64(70 - counter (64 bit))
       9: ifHCInBroadcastPkts - Counter64(70 - counter (64 bit))
       10: ifHCOutOctets - Counter64(70 - counter (64 bit))
       11: ifHCOutUcastPkts - Counter64(70 - counter (64 bit))
       12: ifHCOutMulticastPkts - Counter64(70 - counter (64 bit))
       13: ifHCOutBroadcastPkts - Counter64(70 - counter (64 bit))
       14: ifLinkUpDownTrapEnable - INTEGER(2 - integer (32 bit))
       15: ifHighSpeed - Gauge32(66 - gauge (32 bit))
       16: ifPromiscuousMode - TruthValue(2 - integer (32 bit))
       17: ifConnectorPresent - TruthValue(2 - integer (32 bit))
       18: ifAlias - DisplayString(4 - octets)
       19: ifCounterDiscontinuityTime - TimeStamp(67 - timeticks)
```

## FortiGate防火墙监控指标参数

### 建议监控内容项

| 监控参数明细                   | Object                          | 对应OID值                             | 参数类别（该参数的单位）                                     | 建议的低阈值                           | 建议的高阈值             | 告警级别 | 是否支持SYSLOG告警 | 是否支持SNMP告警 | 是否连续发生多次才告警（如果是，写一个建议值） | 轮询时间 | 备注                                                |
| ------------------------------ | ------------------------------- | ------------------------------------- | ------------------------------------------------------------ | -------------------------------------- | ------------------------ | -------- | ------------------ | ---------------- | ---------------------------------------------- | -------- | --------------------------------------------------- |
| **系统运行时间**               | sysUpTime.0                     | .1.3.6.1.2.1.1.3.0                    | timeTicks (0.01s)                                            | 300天                                  | 330天                    |          |                    |                  |                                                | 1天      |                                                     |
| **当前接口状态**               | ifOperStatus.x                  | .1.3.6.1.2.1.2.2.1.8.x                | INTEGER {up(1),        <br/>down(2),<br/>testing(3),   <br/>unknown(4),   <br/>dormant(5),<br/>notPresent(6),    <br/>lowerLayerDown(7) } | 业务接口up(1).其他为异常               | 业务接口up(1).其他为异常 | 高       | 是                 | 是               | 否                                             | 60秒     | 建议每分钟采样，分别在SPU负载60%、70%时报警         |
| **每个CPU利用率**              | fgProcessorUsage.x              | .1.3.6.1.4.1.2636.3.39.1.12.1.1.1.4.* | 1-100（%）                                                   | 10%                                    | 15%                      | 高       | 是                 | 是               | 否                                             | 60s      |                                                     |
| **多个CPU的总利用率**          | fgSysCpuUsage.0（percentage %） | .1.3.6.1.4.1.12356.101.4.1.3.0        | 1-100（%）                                                   | 10%                                    | 15%                      | 高       | 是                 | 是               | 否                                             | 60秒     | 建议每分钟采样，在SPU负载80%、90%时报警             |
| **内存利用率**                 | fgSysMemUsage.0                 | .1.3.6.1.4.1.12356.101.4.1.4.0        | 1-100（%）                                                   | 40%                                    | 50%                      | 高       | 是                 | 是               | 否                                             | 60秒     |                                                     |
| **并发连接数**                 | fgSysSesCount.0                 | .1.3.6.1.4.1.12356.101.4.1.8.0        | 数字                                                         | 当前并发连接数/设备标称并发连接数＝60% | 80%                      | 高       | 是                 | 是               | 否                                             | 10秒     |                                                     |
| **每秒新建连接数（1秒平均）**  | fgSysSesRate1.0                 | .1.3.6.1.4.1.12356.101.4.1.11.0       | 数字                                                         | 当前并发连接数/设备标称并发连接数＝60% | 80%                      | 高       | 否                 | 是               | 否                                             | 1秒      | 如需要该参数则为1秒。日常采用10,30,60秒的参数即可。 |
| **每秒新建连接数（10秒平均）** | fgSysSesRate10.0                | .1.3.6.1.4.1.12356.101.4.1.12.0       | 数字                                                         | 当前新建连接数/设备标称新建连接数=60%  | 80%                      | 高       | 否                 | 是               | 否                                             | 10秒     |                                                     |
| **每秒新建连接数（30秒平均）** | fgSysSesRate30.0                | .1.3.6.1.4.1.12356.101.4.1.13.0       | 数字                                                         | 当前新建连接数/设备标称新建连接数=60%  | 80%                      | 高       | 否                 | 是               | 否                                             | 30秒     |                                                     |
| **每秒新建连接数（60秒平均**   | fgSysSesRate60.0                | .1.3.6.1.4.1.12356.101.4.1.14.0       | 数字                                                         | 当前新建连接数/设备标称新建连接数=60%  | 80%                      | 高       | 否                 | 是               | 否                                             | 60秒     |                                                     |
| **协议错误丢包**               | ipInHdrErrors.0                 | .1.3.6.1.2.1.4.4.0                    | 数字，IP包头错误个数，累加                                   | 大于正常流量下该值峰值的120%           | 150%                     | 高       | 否                 | 是               | 否                                             | 60秒     |                                                     |
| **接口流量（in）**             | ifHCInOctets.x                  | .1.3.6.1.2.1.31.1.1.1.6.x             | 数字，单位bit                                                |                                        |                          | 高       | 否                 | 是               | 否                                             | 60秒     |                                                     |
| **接口流量（out）**            | ifHCOutOctets.x                 | .1.3.6.1.2.1.31.1.1.1.10.x            | 数字，单位bit                                                |                                        |                          | 高       | 否                 | 是               | 否                                             | 60秒     |                                                     |
| **接口包转发数（in）**         | ifInUcastPkts.x                 | .1.3.6.1.2.1.2.2.1.11.x               | 数字：单播数据包数量                                         |                                        |                          | 高       | 否                 | 是               | 否                                             | 60秒     |                                                     |
| **接口包转发数（out）**        | ifOutUcastPkts.x                | .1.3.6.1.2.1.2.2.1.17.x               | 数字：单播数据包数量                                         |                                        |                          | 高       | 否                 | 是               | 否                                             | 60秒     |                                                     |
| **接口丢包（in）**             | ifInDiscards.x                  | .1.3.6.1.2.1.2.2.1.13.x               | 数字：单播数据包数量                                         | 丢包率（丢包数/总包数）<0.5%           | 1%                       | 高       | 否                 | 是               | 否                                             | 60秒     |                                                     |
| **接口丢包（out）**            | ifOutDiscards.x                 | .1.3.6.1.2.1.2.2.1.19.x               | 数字：单播数据包数量                                         | 丢包率（丢包数/总包数）<0.5%           | 1%                       | 高       | 否                 | 是               | 否                                             | 60秒     |                                                     |
| **接口错包（in）**             | ifInErrors.x                    | .1.3.6.1.2.1.2.2.1.14.x               | 数字                                                         | 错包率（错包数/总包数）<0.5%           | 1%                       | 高       | 否                 | 是               | 否                                             | 60秒     |                                                     |
| **接口错包（out）**            | ifOutErrors.x                   | .1.3.6.1.2.1.2.2.1.20.x               | 数字                                                         | 错包率（错包数/总包数）<0.5%           | 1%                       | 高       | 否                 | 是               | 否                                             | 60秒     |                                                     |

### 系统状态监控项

| 监控参数明细                   | Object                    | 对应OID值                          | 参数类别（该参数的单位） | 建议的低阈值                           | 建议的高阈值 | 告警级别 | 是否支持SYSLOG告警 | 是否支持SNMP告警 | 是否连续发生多次才告警 | 轮询时间 | 备注                                                |
| ------------------------------ | ------------------------- | ---------------------------------- | ------------------------ | -------------------------------------- | ------------ | -------- | ------------------ | ---------------- | ---------------------- | -------- | --------------------------------------------------- |
| **主机名称**                   | sysName.0                 | .1.3.6.1.2.1.1.5.0                 | 字符串                   |                                        |              |          |                    |                  |                        |          |                                                     |
| **设备序列号**                 | fnSysSerial.0             | .1.3.6.1.4.1.12356.100.1.1.1.0     | 字符串                   |                                        |              |          |                    |                  |                        |          |                                                     |
| **系统运行时间**               | sysUpTime.0               | .1.3.6.1.2.1.1.3.0                 | timeTicks (0.01s)        | 300天                                  | 330天        |          |                    |                  |                        | 1天      |                                                     |
| **系统版本**                   | fgsSysVersion             | .1.3.6.1.4.1.12356.101.4.1.1.0     | 字符串                   |                                        |              |          |                    |                  |                        |          |                                                     |
| **系统CPU数量**                | fgProcModProcessorCount.1 | .1.3.6.1.4.1.12356.101.4.5.3.1.5.1 | 正整数                   |                                        |              |          |                    |                  |                        |          |                                                     |
| **每个CPU利用率(1分钟)**       | fgProcessorUsage.x        | .1.3.6.1.4.1.12356.101.4.4.2.1.2.X | 1-100（%）               | 10%                                    | 15%          | 高       | 是                 | 是               | 否                     | 60秒     | 建议每分钟采样，分别在SPU负载60%、70%时报警         |
| **每个CPU利用率(5秒钟)**       | fgProcessorUsage5sec.x    | .1.3.6.1.4.1.12356.101.4.4.2.1.3.x | 1-100（%）               | 10%                                    | 15%          |          |                    |                  |                        |          |                                                     |
| **多个CPU的总利用率**          | fgSysCpuUsage.0           | .1.3.6.1.4.1.12356.101.4.1.3.0     | 1-100（%）               | 10%                                    | 15%          | 高       | 是                 | 是               | 否                     | 60秒     | 建议每分钟采样，在SPU负载80%、90%时报警             |
| **内存利用率**                 | fgSysMemUsage.0           | .1.3.6.1.4.1.12356.101.4.1.4.0     | 1-100（%）               | 40%                                    | 50%          | 高       | 是                 | 是               | 否                     | 60秒     |                                                     |
| **总内存大小**                 | fgSysMemCapacity.0        | .1.3.6.1.4.1.12356.101.4.1.5.0     | 单位（kb）               |                                        |              |          |                    |                  |                        |          |                                                     |
| **并发连接数**                 | fgSysSesCount.0           | .1.3.6.1.4.1.12356.101.4.1.8.0     | 数字                     | 当前并发连接数/设备标称并发连接数＝60% | 80%          | 高       | 是                 | 是               | 否                     | 10秒     |                                                     |
| **每秒新建连接数（1秒平均）**  | fgSysSesRate1.0           | .1.3.6.1.4.1.12356.101.4.1.11.0    | 数字                     | 当前新建连接数/设备标称新建连接数=60%  | 80%          | 高       | 否                 | 是               | 否                     | 1秒      | 如需要该参数则为1秒。日常采用10,30,60秒的参数即可。 |
| **每秒新建连接数（10秒平均）** | fgSysSesRate10.0          | .1.3.6.1.4.1.12356.101.4.1.12.0    | 数字                     | 当前新建连接数/设备标称新建连接数=60%  | 80%          | 高       | 否                 | 是               | 否                     | 10秒     |                                                     |
| **每秒新建连接数（30秒平均）** | fgSysSesRate30.0          | .1.3.6.1.4.1.12356.101.4.1.13.0    | 数字                     | 当前新建连接数/设备标称新建连接数=60%  | 80%          | 高       | 否                 | 是               | 否                     | 30秒     |                                                     |
| **每秒新建连接数（60秒平均）** | fgSysSesRate60.0          | .1.3.6.1.4.1.12356.101.4.1.14.0    | 数字                     | 当前新建连接数/设备标称新建连接数=60%  | 80%          | 高       | 否                 | 是               | 否                     | 60秒     |                                                     |

### 接口状态监控项

| 监控参数明细                               | Object                   | 对应OID值.x<br/>（x为接口ID）                                | 参数类别（该参数的单位）                                     | 建议的低阈值                                                 | 建议的高阈值                          | 告警级别 | 是否支持SYSLOG告警 | 是否支持SNMP告警 | 是否连续发生多次才告警 | 轮询时间 |
| ------------------------------------------ | ------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------- | -------- | ------------------ | ---------------- | ---------------------- | -------- |
| **IfEntry(基础表)** |  
| **系统接口数量**                           | ifNumber.0               | .1.3.6.1.2.1.2.1.0                                           | 正整数                                                       |                                                              |                                       |          |                    |                  |                        |          |
| **接口ID**                                 | ifIndex                  | .1.3.6.1.2.1.2.2.1.1                                         | 1.2.3….自然数                                                |                                                              |                                       |          |                    |                  |                        |          |
| **接口MTU**                                | ifMtu.x                  | .1.3.6.1.2.1.2.2.1.4.x                                       | 正整数                                                       | 默认为1500                                                   |                                       |          |                    |                  |                        |          |
| **接口速率**                               | ifSpeed.x                | .1.3.6.1.2.1.2.2.1.5.x                                       | 正整数,单位:bit                                              |                                                              |                                       |          |                    |                  |                        |          |
| **接口管理状态**                           | ifAdminStatus.x          | .1.3.6.1.2.1.2.2.1.7.x                                       | INTEGER {up(1),        down(2)}                              | up,或者被shutdown                                            | 业务口需为up                          |          |                    |                  |                        |          |
| **接口工作状态**                           | ifOperStatus.x           | .1.3.6.1.2.1.2.2.1.8.x                                       | INTEGER {up(1),        <br/>down(2),<br/>testing(3),   <br/>unknown(4),   <br/>dormant(5),<br/>notPresent(6),    <br/>lowerLayerDown(7) } | 业务接口up(1).其他为异常                                     | 业务接口up(1).其他为异常              | 高       | 是                 | 是               | 否                     | 60秒     |
| **接口流量（in）**                         | ifInOctets.x             | .1.3.6.1.2.1.2.2.1.10.x                                      | 数字(32位)，字节                                             | 计算差值-日常值的120%                                        | 数量不超正常平均值150%.如下简写为150% | 高       | 否                 | 是               | 否                     | 30-60秒  |
| **接口单播包转发数（in）**                 | ifInUcastPkts.x          | .1.3.6.1.2.1.2.2.1.11.x                                      | 数字(32位)，个                                               | 计算差值-日常值的120%                                        | 150%                                  | 高       | 否                 | 是               | 否                     | 60秒     |
| **接口非单播包转发数（in）**               | ifInNUcastPkts.x         | .1.3.6.1.2.1.2.2.1.12.x                                      | 数字(32位)，个                                               | 计算差值-日常值的120%                                        | 150%                                  |          |                    |                  |                        | 60秒     |
| **接口丢包（in）**                         | ifInDiscards.x           | .1.3.6.1.2.1.2.2.1.13.x                                      | 数字(32位)，个                                               | 计算差值-日常值的120%                                        | 150%                                  | 高       | 否                 | 是               | 否                     | 60秒     |
| **接口错包（in）**                         | ifInErrors.x             | .1.3.6.1.2.1.2.2.1.14.x                                      | 数字(32位)，个                                               | 错包率（错包数/总包数）<0.5%                                 | 1%                                    | 高       | 否                 | 是               | 否                     | 60秒     |
| **丢弃的未知协议包**                       | ifInUnknownProtos.x      | .1.3.6.1.2.1.2.2.1.15.x                                      | 数字(32位)，个                                               |                                                              |                                       | 高       | 否                 | 是               | 否                     | 60秒     |
| **接口流量（out）**                        | ifOutOctets.x            | .1.3.6.1.2.1.2.2.1.16.x                                      | 数字(32位)，字节                                             | 计算差值-日常值的120%                                        | 150%                                  | 高       | 否                 | 是               | 否                     | 30-60秒  |
| **接口单播包转发数（out）**                | ifOutUcastPkts.x         | .1.3.6.1.2.1.2.2.1.17.x                                      | 数字(32位)，个                                               | 计算差值-日常值的120%                                        | 150%                                  | 高       | 否                 | 是               | 否                     | 60秒     |
| **接口非单播包转发数（out）**              | ifOutNUcastPkts.x        | .1.3.6.1.2.1.2.2.1.18.x                                      | 数字(32位)，个                                               | 计算差值-日常值的120%                                        | 150%                                  | 高       | 否                 | 是               | 否                     | 60秒     |
| **接口丢包（out）**                        | ifOutDiscards.x          | .1.3.6.1.2.1.2.2.1.19.x                                      | 数字(32位)，个                                               | 丢包率（丢包数/总包数）<0.5%                                 | 1%                                    | 高       | 否                 | 是               | 否                     | 60秒     |
| **接口错包（out）**                        | ifOutErrors.x            | .1.3.6.1.2.1.2.2.1.20.x                                      | 数字(32位)，个                                               | 丢包率（丢包数/总包数）<0.5%                                 | 1%                                    | 高       | 否                 | 是               | 否                     | 60秒     |
| **IfXEntry (增强表）** |
| **接口名字**                               | ifName.x                 | .1.3.6.1.2.1.31.1.1.1.1.x                                    | 字符串                                                       |                                                              |                                       |          |                    |                  |                        |          |
| **接口多播包转发数（in）**                 | ifInMulticastPkts.x      | .1.3.6.1.2.1.31.1.1.1.2.x                                    | 数字(32位)，个                                               | 计算差值-日常值的120%                                        | 150%                                  | 中       | 否                 | 是               | 否                     | 60-120秒 |
| **接口广播包转发数（in）**                 | ifInBroadcastPkts.x      | .1.3.6.1.2.1.31.1.1.1.3.x                                    | 数字(32位)，个                                               | 计算差值-日常值的120%                                        | 150%                                  | 高       | 否                 | 是               | 否                     | 60-120秒 |
| **接口多播包转发数（out）**                | ifOutMulticastPkts.x     | .1.3.6.1.2.1.31.1.1.1.4.x                                    | 数字(32位)，个                                               | 计算差值-日常值的120%                                        | 150%                                  | 中       | 否                 | 是               | 否                     | 60-120秒 |
| **接口广播包转发数（out）**                | ifOutBroadcastPkts.x     | .1.3.6.1.2.1.31.1.1.1.5.x                                    | 数字(32位)，个                                               | 计算差值-日常值的120%                                        | 150%                                  | 高       | 否                 | 是               | 否                     | 60-120秒 |
| **接口流量（in）64位**                     | ifHCInOctets.x           | .1.3.6.1.2.1.31.1.1.1.6.x                                    | 数字(64位)，字节                                             | 计算差值-日常值的120%                                        | 150%                                  | 高       | 否                 | 是               | 否                     | 60-120秒 |
| **接口单播包转发数（in）64位**             | ifHCInUcastPkts.x        | .1.3.6.1.2.1.31.1.1.1.7.x                                    | 数字(64位)，个                                               | 计算差值-日常值的120%                                        | 150%                                  | 高       | 否                 | 是               | 否                     | 60-120秒 |
| **接口多播包转发数（in）64位**             | ifHCInMulticastPkts.x    | .1.3.6.1.2.1.31.1.1.1.8.x                                    | 数字(64位)，个                                               | 计算差值-日常值的120%                                        | 150%                                  | 低       | 否                 | 是               | 否                     | 60-120秒 |
| **接口广播包转发数（in）64位**             | ifHCInBroadcastPkts.x    | .1.3.6.1.2.1.31.1.1.1.9.x                                    | 数字(64位)，个                                               | 计算差值-日常值的120%                                        | 150%                                  | 低       | 否                 | 是               | 否                     | 60-120秒 |
| **接口流量（out）64位**                    | ifHCOutOctets.x          | .1.3.6.1.2.1.31.1.1.1.10.x                                   | 数字(64位)，字节                                             | 计算差值-日常值的120%                                        | 150%                                  | 高       | 否                 | 是               | 否                     | 60-120秒 |
| **接口单播包转发数（out）64位**            | ifHCOutUcastPkts.x       | .1.3.6.1.2.1.31.1.1.1.11.x                                   | 数字(64位)，个                                               | 计算差值-日常值的120%                                        | 150%                                  | 高       | 否                 | 是               | 否                     | 60-120秒 |
| **接口多播包转发数（out）64位**            | ifHCOutMulticastPkts.x   | .1.3.6.1.2.1.31.1.1.1.12.x                                   | 数字(64位)，个                                               | 计算差值-日常值的120%                                        | 150%                                  | 中       | 否                 | 是               | 否                     | 60-120秒 |
| **接口广播包转发数（out）64位**            | ifHCOutBroadcastPkts.x   | .1.3.6.1.2.1.31.1.1.1.13.x                                   | 数字(64位)，个                                               | 计算差值-日常值的120%                                        | 150%                                  | 高       | 否                 | 是               | 否                     | 60-120秒 |
| **接口updown状态变化是否发送trap**         | ifLinkUpDownTrapEnable.x | .1.3.6.1.2.1.31.1.1.1.14.x                                   | 1：enable, 2:其他                                            | 默认为1                                                      | 必须为1                               | 高       | 否                 | 是               | 否                     |          |
| **接口速率**                               | ifHighSpeed.x            | .1.3.6.1.2.1.31.1.1.1.15.x                                   | 正整数,单位:Mbit                                             | 1000 or 10000                                                | 端口必须正常协商                      |          |                    |                  |                        |          |
| **复合参数** |
| **接口bps（in）<br/>Inbound Throughput**   | 使用复合表达式           | 吞吐量：间隔t秒执行2次获取ifHCInOctets.x (.1.3.6.1.2.1.31.1.1.1.6.x)的值，结果分别为ifHCInOctets.x.time1和ifHCInOctets.x.time2。<br/>interface x的in_bps = ( ifHCInOctets.x.time2 - ifHCInOctets.x.time1) * 8 / t | 吞吐量：数字,bps                                             | 吞吐率＝接口吞吐量/接口最大吞吐量=60%<br/>Inbound Utilization | 80%                                   | 高       | 否                 | 是               | 否                     | 30-60秒  |
| **接口bps（out）<br/>Outbound Throughput** | 使用复合表达式           | 吞吐量：间隔t秒执行2次获取ifHCOutOctets.x的值，结果分别为ifHCOutOctets.x.time1和ifHCOutOctets.x.time2。<br/>interface x的out_bps = ( ifHCOutOctets.x.time2 - ifHCOutOctets.x.time1) * 8 / t | 吞吐量：数字,bps                                             | 吞吐率＝接口吞吐量/接口最大吞吐量=60<br/>Outbound Utilization | 80%                                   | 高       | 否                 | 是               | 否                     | 30-60秒  |

### TCP/IP/策略监控项

| 监控参数明细                     | Object                            | 对应OID值                              | 参数类别（该参数的单位） | 建议的低阈值          | 建议的高阈值 | 告警级别 | 是否支持SYSLOG告警 | 是否支持SNMP告警 | 是否连续发生多次才告警 | 轮询时间 |
| -------------------------------- | --------------------------------- | -------------------------------------- | ------------------------ | --------------------- | ------------ | -------- | ------------------ | ---------------- | ---------------------- | -------- |
| **IP** | 
| **端口接收到的ip报文总数**       | ipInReceives.0                    | .1.3.6.1.2.1.4.3.0                     | 数字（32位)，个          | 计算差值-日常值的120% | 150%         | 低       | 否                 | 是               | 否                     | 120秒    |
| **IP头部错误丢包**               | ipInHdrErrors.0                   | .1.3.6.1.2.1.4.4.0                     | 数字（32位)，个          | 计算差值-日常值的120% | 150%         | 高       | 否                 | 是               | 是,3次                 | 120秒    |
| **IP目标地址错误丢弃包**         | ipInAddrErrors.0                  | .1.3.6.1.2.1.4.5.0                     | 数字（32位)，个          | 计算差值-日常值的120% | 150%         | 高       | 否                 | 是               | 是,3次                 | 120秒    |
| **未知协议数据包**               | ipInUnknownProtos                 | .1.3.6.1.2.1.4.7.0                     | 数字（32位)，个          | 计算差值-日常值的120% | 150%         | 高       | 否                 | 是               | 是,3次                 | 120秒    |
| **被丢弃的IP包（如缓冲区不够）** | ipInDiscards.0                    | .1.3.6.1.2.1.4.8.0                     | 数字（32位)，个          | 计算差值-日常值的120% | 150%         | 高       | 否                 | 是               | 是,3次                 | 120秒    |
| **被转发包的IP包，包括ICMP**     | ipInDelivers.0                    | .1.3.6.1.2.1.4.9.0                     | 数字（32位)，个          | 计算差值-日常值的120% | 150%         | 低       | 否                 | 是               | 否                     | 120秒    |
| **需重组数据包**                 | ipReasmReqds.0                    | .1.3.6.1.2.1.4.14.0                    | 数字（32位)，个          | 计算差值-日常值的120% | 150%         | 低       | 否                 | 是               | 否                     | 120秒    |
| **重组成功数据包**               | ipReasmOKs.0                      | .1.3.6.1.2.1.4.15.0                    | 数字（32位)，个          | 计算差值-日常值的120% | 150%         | 低       | 否                 | 是               | 否                     | 120秒    |
| **重组失败数据包**               | ipReasmFails.0                    | .1.3.6.1.2.1.4.16.0                    | 数字（32位)，个          | 计算差值-日常值的120% | 150%         | 高       | 否                 | 是               | 是,3次                 | 120秒    |
| **分片成功数据包**               | ipFragOKs.0                       | .1.3.6.1.2.1.4.17.0                    | 数字（32位)，个          | 计算差值-日常值的120% | 150%         | 低       | 否                 | 是               | 否                     | 120秒    |
| **分片失败数据包**               | ipFragFails.0                     | .1.3.6.1.2.1.4.18.0                    | 数字（32位)，个          | 计算差值-日常值的120% | 150%         | 高       | 否                 | 是               | 是,3次                 | 120秒    |
| **TCP** |
| **TCP数据分组（in）**            | tcpInSegs.0                       | .1.3.6.1.2.1.6.10.0                    | 数字（32位)，个          | 计算差值-日常值的120% | 150%         | 低       | 否                 | 是               | 否                     | 120秒    |
| **TCP数据分组（out）**           | tcpOutSegs.0                      | .1.3.6.1.2.1.6.11.0                    | 数字（32位)，个          | 计算差值-日常值的120% | 150%         | 低       | 否                 | 是               | 否                     | 120秒    |
| **重传的数据分组**               | tcpRetransSegs.0                  | .1.3.6.1.2.1.6.12.0                    | 数字（32位)，个          | 计算差值-日常值的120% | 150%         | 高       | 否                 | 是               | 否                     | 120秒    |
| **接收到的TCP错包**              | tcpInErrs.0                       | .1.3.6.1.2.1.6.14.0                    | 数字（32位)，个          | 计算差值-日常值的120% | 150%         | 高       | 否                 | 是               | 是,3次                 | 120秒    |
| **发送的RST数据包**              | tcpOutRsts.0                      | .1.3.6.1.2.1.6.15.0                    | 数字（32位)，个          | 计算差值-日常值的120% | 150%         | 高       | 否                 | 是               | 是,3次                 | 120秒    |
| **Policy** |
| 策略命中包数                     | fgFwPolPktCount.1.x（x为策略ID）  | .1.3.6.1.4.1.12356.101.5.1.2.1.1.2.1.x | 动作为deny或permit       |                       |              |          |                    |                  |                        |          |
| 策略命中字节数                   | fgFwPolByteCount.1.x（x为策略ID） | .1.3.6.1.4.1.12356.101.5.1.2.1.1.3.x   | 动作为deny或permit       |                       |              |          |                    |                  |                        |          |

汇总的附件下载（包括mib文件、exel监控说明、一些常用监控平台的模板等等内容）：[<a href="../../../files/FortiGate_SNMP监控之Cacti_Zabbix_PRTG_ALL.zip" target="_blank">FortiGate_SNMP监控之Cacti_Zabbix_PRTG_ALL</a>](../../../files/FortiGate_SNMP监控之Cacti_Zabbix_PRTG_ALL.zip)。

